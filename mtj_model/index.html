
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://salah-daddi-nounou.github.io/mtj_model/">
      
      
        <link rel="prev" href="../out_neuron/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>MTJ - SNN simulator</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SNN simulator" class="md-header__button md-logo" aria-label="SNN simulator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SNN simulator
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MTJ
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/salah-daddi-nounou/snn_simulator" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    snn_simulator
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../usage/" class="md-tabs__link">
        
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../workflow/" class="md-tabs__link">
        
  
    
  
  Simulation Workflow

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../api/" class="md-tabs__link">
          
  
    
  
  API Refrence

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SNN simulator" class="md-nav__button md-logo" aria-label="SNN simulator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    SNN simulator
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/salah-daddi-nounou/snn_simulator" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    snn_simulator
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulation Workflow
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Refrence
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Refrence
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Device Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Device Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../in_neuron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Neuron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../out_neuron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Output Neuron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    MTJ
  </span>
  

      </a>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/salah-daddi-nounou/snn_simulator/edit/master/docs/mtj_model.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/salah-daddi-nounou/snn_simulator/raw/master/docs/mtj_model.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>MTJ</h1>

<details>
  <summary>Verilog-A model of MTJ device</summary>

<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="cm">/* Copyright @ 2018 Fert Beijing Institute, BDBC and School of Electronic and Information Engineering, Beihang Univeristy, Beijing 100191, China</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="cm">The terms under which the software and associated documentation (the Software) is provided are as the following:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="cm">The Software is provided &quot;as is&quot;, without warranty of any kind, express or implied, including but not limited to the warranties of merchantability, fitness for a particular purpose and noninfringement. In no event shall the authors or copyright holders be liable for any claim, damages or other liability, whether in an action of contract, tort or otherwise, arising from, out of or in connection with the Software or the use or other dealings in the Software.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="cm">The authors or copyright holders grants, free of charge, to any users the right to modify, copy, and redistribute the Software, both within the user&#39;s organization and externally, subject to the following restrictions:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="cm">1. The users agree not to charge for the code itself but may charge for additions, extensions, or support.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="cm">2. In any product based on the Software, the users agree to acknowledge the Research Group that developed the software. This acknowledgment shall appear in the product documentation.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="cm">3. The users agree to reproduce any copyright notice which appears on the software on any copy or modification of such made available to others.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="cm">Agreed to by </span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="cm">You WANG, Yue Zhang, Weisheng Zhao, Lirida Alves de Barros Naviner, Hao Cai and Jaques-Olivier Klein</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="cm">//Title: Compact model of Perpendicular Magnetic Anistropy (PMA) MTJ based on Spin transfer torque mechanism</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="cm">//Version: Beta.4.5</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="cm">//Date:20 April 2020</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="cm">//Language: VerilogA</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="cm">-------------------------------------------</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="cm">In this model, it takes into account the static, dynamic and stochastic behavoirs of PMA MTJ nanopillar</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="cm">1.MTJ resistance calculation based on brinkman model</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="cm">2.TMR dependence on the bias voltage</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="cm">3.Spin polarity calculation model for magnetic tunnel junction</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="cm">4.Critical current calculation </span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="cm">5.Dynamic model (&gt;critical current, also sun&#39;s model)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="cm">6.Stochastic model </span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="cm">7.Resistance variation</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="cm">8.Temperature evaluation</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="cm">-------------</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="cm">Modified by Salah DADDINOUNOU</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="cm">// Optimized the code and removed redundancy.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="cm">// Signal ix is set to 0 or 1 not 0 or -1 (it was set negative to indecate that the current flows out, when there were a probing termnial)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="cm">// Removed the probing terminals because the framework allows direct access to signals. Removed also temp terminal.   </span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="cm">*/</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="cm">/*--------------------The parameters are from the prototypes of Univ. Tohuku-------------------*/</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="no">`resetall</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="no">`include</span><span class="w"> </span><span class="s">&quot;constants.vams&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="no">`include</span><span class="w"> </span><span class="s">&quot;disciplines.vams&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="cp">`define explimit 85.0</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="cp">`define exp(x) exp(min(max((x),-`explimit),`explimit))</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="cp">`define sqrt(x) pow( (x), 0.5)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="cp">`define rec 1           </span><span class="c1">//Shape definition</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="cp">`define ellip 2</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="cp">`define circle 3</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="cm">/*----------------------------Electrical Constants-----------------------------*/</span><span class="w"> </span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="cm">/*----------Elementary Charge---------------*/</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="cp">`define e 1.6e-19</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="cm">/*----------Bohr Magnetron Costant----------*/</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="cp">`define ub 9.27e-28</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="cm">/*----------Boltzmann Constant------------- */</span><span class="w"> </span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="cp">`define Kb 1.38e-23</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="cm">/*----------Electron Mass------------- */</span><span class="w"> </span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="cp">`define m 9.10e-31</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="cm">/*----------Euler&#39;s constant---------------*/</span><span class="w"> </span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="cp">`define C 0.577</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a><span class="k">module</span><span class="w"> </span><span class="n">Model</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">);</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="k">inout</span><span class="w"> </span><span class="n">T1</span><span class="p">,</span><span class="w"> </span><span class="n">T2</span><span class="p">;</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a><span class="n">electrical</span><span class="w"> </span><span class="n">T1</span><span class="p">,</span><span class="w"> </span><span class="n">T2</span><span class="p">;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a><span class="n">electrical</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">;</span><span class="w"> </span><span class="c1">//virtual terminals of RC circuit for temperature evaluation </span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a><span class="cm">/*----------Ttrans=store the state of the MTJ with time influence, non-volatile way------------- */</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a><span class="cm">/*--------------------MTJ Technology Parameters(Corresponds to the HITACHI MTJ Process)-------------*/</span><span class="w"> </span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a><span class="cm">/*----------Gilbert Damping Coefficient---------------*/</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.027</span><span class="p">;</span>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a><span class="cm">/*----------GyroMagnetic Constant in Hz/Oe---------------*/</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">gamma</span><span class="o">=</span><span class="mf">1.76e7</span><span class="p">;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a><span class="cm">/*----------Electron Polarization Percentage % ---------------*/</span><span class="w"> </span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">P</span><span class="o">=</span><span class="mf">0.52</span><span class="p">;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a><span class="cm">/*----------Out of plane Magnetic Anisotropy in Oersteds---------------*/</span><span class="w"> </span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">Hk</span><span class="o">=</span><span class="mh">1433</span><span class="p">;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a><span class="cm">/*----------Saturation Field in the Free Layer in Oersteds---------------*/</span>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">Ms</span><span class="o">=</span><span class="mh">15800</span><span class="p">;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a><span class="cm">/*----------The Energy Barrier Height for MgO in electron-volt---------------*/</span><span class="w"> </span>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">PhiBas</span><span class="o">=</span><span class="mf">0.4</span><span class="p">;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a><span class="cm">/*----------Voltage bias when the TMR(real) is 1/2TMR(0) in Volt---------------*/</span><span class="w"> </span>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">Vh</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="c1">//experimental value with MgO barrier</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a><span class="cm">/*--------------Device Parameters(Corresponds to the HITACHI 240 x 80 MTJ)--------------------------*/</span><span class="w"> </span>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="cm">/*----------Height of the Free Layer in nm---------------*/</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">tsl</span><span class="o">=</span><span class="mf">1.3e-9</span><span class="w"> </span><span class="n">from</span><span class="p">[</span><span class="mf">0.7e-9</span><span class="o">:</span><span class="mf">3.0e-9</span><span class="p">];</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="cm">/*----------Length in nm---------------*/</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="mf">32e-9</span><span class="p">;</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a><span class="cm">/*----------Width in nm---------------*/</span>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">b</span><span class="o">=</span><span class="mf">32e-9</span><span class="p">;</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a><span class="cm">/*----------Radius in nm---------------*/</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">r</span><span class="o">=</span><span class="mf">16e-9</span><span class="p">;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a><span class="cm">/*----------Height of the Oxide Barrier in nm---------------*/</span><span class="w"> </span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">tox</span><span class="o">=</span><span class="mf">8.5e-10</span><span class="w"> </span><span class="n">from</span><span class="p">[</span><span class="mf">8e-10</span><span class="o">:</span><span class="mf">15e-10</span><span class="p">];</span><span class="w"> </span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a><span class="cm">/*----------TMR(0) with Zero Volt Bias Voltage ---------------*/</span><span class="w"> </span>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">TMR</span><span class="o">=</span><span class="mf">0.7</span><span class="p">;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a><span class="cm">/*----------Shape of MTJ---------------*/</span>
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">SHAPE</span><span class="o">=</span><span class="mh">3</span><span class="w"> </span><span class="n">from</span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">3</span><span class="p">];</span><span class="w">    </span><span class="c1">// 1:rectangle  2:ellipse 3:circle</span>
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a><span class="cm">/*----------Neel-Brown model parameter ---------------*/</span>
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">tau0</span><span class="o">=</span><span class="mf">8.7e-10</span><span class="p">;</span><span class="w"> </span><span class="c1">//experiental value, prototype Hitachi 2007m with CoFe layer </span>
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a><span class="cm">/*----------Error probability Ps=1-Pr(t) ----------------*/</span>
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">Ps</span><span class="o">=</span><span class="mf">0.999999</span><span class="p">;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a><span class="cm">/*----------Threshold for Neel-Brown model----------------*/</span>
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">brown_threshold_AP2P</span><span class="o">=</span><span class="mf">0.15</span><span class="p">;</span><span class="w">   </span>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">brown_threshold_P2AP</span><span class="o">=</span><span class="mf">0.1</span><span class="p">;</span><span class="w">   </span>
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a><span class="cm">/*----------MTJ State Parameters----------------*/</span>
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a><span class="cm">/*----------Initial state of the MTJ, 0 = parallele, 1 = anti-parallele----*/</span><span class="w"> </span>
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a><span class="k">parameter</span><span class="w"> </span><span class="k">integer</span><span class="w"> </span><span class="n">PAP</span><span class="o">=</span><span class="mh">1</span><span class="w"> </span><span class="n">from</span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">1</span><span class="p">];</span><span class="w"> </span>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a><span class="cm">/*----------Room temperature in Kelvin----------------*/</span>
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">T</span><span class="o">=</span><span class="w"> </span><span class="mh">300</span><span class="p">;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a><span class="cm">/*----------Resistance area product in ohmum2----------------*/</span><span class="w"> </span>
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">RA</span><span class="o">=</span><span class="mh">5</span><span class="w"> </span><span class="n">from</span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">15</span><span class="p">];</span>
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a><span class="cm">/*----------Parameters of RC circuit for time modelisation for temperature---------------*/</span>
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a><span class="k">parameter</span><span class="w"> </span><span class="k">integer</span><span class="w"> </span><span class="n">Temp_var</span><span class="o">=</span><span class="mh">0</span><span class="w"> </span><span class="n">from</span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">1</span><span class="p">];</span><span class="w"> </span><span class="c1">//choice of temperature fluctuation</span>
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a><span class="cm">/*----------Heat capacity per unit volume in J/m3*K----------------*/</span>
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">Cv</span><span class="o">=</span><span class="w"> </span><span class="mf">2.74e6</span><span class="w"> </span><span class="n">from</span><span class="p">[</span><span class="mf">2.735e6</span><span class="o">:</span><span class="mf">2.7805e6</span><span class="p">];</span>
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a><span class="cm">/*----------Thermal conductivity of the thermal barrier(MgO) in W/m*K----------------*/</span><span class="w"> </span>
<a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">lam</span><span class="o">=</span><span class="w"> </span><span class="mf">84.897</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="p">[</span><span class="mf">84.8912</span><span class="o">:</span><span class="mf">84.9449</span><span class="p">];</span>
<a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a><span class="cm">/*----------Total thickness of MTJ nanopillar in nm----------------*/</span>
<a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">thick_s</span><span class="o">=</span><span class="w"> </span><span class="mf">3.355e-8</span><span class="p">;</span>
<a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a><span class="cm">/*----------RC circuit for time modelisation for temperature---------------*/</span><span class="w"> </span>
<a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">resistor</span><span class="o">=</span><span class="mf">100e6</span><span class="p">;</span>
<a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">coeff_tau</span><span class="o">=</span><span class="mh">12</span><span class="p">;</span><span class="w">    </span><span class="c1">//Coefficient to increase tau_th</span>
<a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a><span class="kt">real</span><span class="w"> </span><span class="n">capacitor</span><span class="p">;</span><span class="w">                 </span><span class="c1">//virtual capacitor</span>
<a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a><span class="kt">real</span><span class="w"> </span><span class="n">tau_th</span><span class="p">;</span><span class="w">                    </span><span class="c1">//characteristic heating/cooling time</span>
<a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a><span class="kt">real</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span><span class="w">                      </span><span class="c1">//real temperature of MTJ</span>
<a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a><span class="kt">real</span><span class="w"> </span><span class="n">temp_init</span><span class="p">;</span><span class="w">                 </span><span class="c1">//temperature initialised</span>
<a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a><span class="kt">real</span><span class="w"> </span><span class="n">R</span><span class="p">;</span><span class="w">                         </span><span class="c1">//resistance of MTJ</span>
<a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a><span class="cm">/*---------Parameters for stochasticity and variability behaviors---------------*/</span>
<a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a><span class="k">parameter</span><span class="w"> </span><span class="k">integer</span><span class="w"> </span><span class="n">STO</span><span class="o">=</span><span class="mh">0</span><span class="w"> </span><span class="n">from</span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">2</span><span class="p">];</span><span class="w">          </span><span class="c1">// stochasticity: 0=no stochastic, 1=random exponential distribution, 2=random gauss distribution</span>
<a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a><span class="k">parameter</span><span class="w"> </span><span class="k">integer</span><span class="w"> </span><span class="n">RV</span><span class="o">=</span><span class="mh">0</span><span class="w"> </span><span class="n">from</span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">2</span><span class="p">];</span><span class="w">           </span><span class="c1">// process varibility: 0 no var, 1 random uniform distribution,2 random gauss distribution</span>
<a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">dev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w">                     </span><span class="c1">// intermediate std parameter to be used bellow</span>
<a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">DEV_tox</span><span class="o">=</span><span class="n">dev</span><span class="p">;</span><span class="w"> </span><span class="c1">//0.03;         // variability std for gauss distribution(RV=2) of tox (oxide thickness) </span>
<a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">DEV_tsl</span><span class="o">=</span><span class="n">dev</span><span class="p">;</span><span class="w"> </span><span class="c1">//0.03;         // variability std for gauss distribution(RV=2) of tsl (FL thickness)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">DEV_TMR</span><span class="o">=</span><span class="n">dev</span><span class="p">;</span><span class="w"> </span><span class="c1">//0.03;         // variability std for gauss distribution(RV=2) of TMR </span>
<a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a><span class="k">parameter</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="n">STO_dev</span><span class="o">=</span><span class="mh">1</span><span class="p">;</span><span class="w">                   </span><span class="c1">// stochasticity std for gauss distribution(STO=2) of duration      </span>
<a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a><span class="cm">/*------------------------------------variables-------------------------------------*/</span>
<a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a><span class="c1">//Polaristion constant for the two states of STT-MTJ</span>
<a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a><span class="kt">real</span><span class="w"> </span><span class="n">PolaP</span><span class="p">;</span><span class="w">         </span><span class="c1">//Polarization state parallel of STT-MTJ</span>
<a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a><span class="kt">real</span><span class="w"> </span><span class="n">PolaAP</span><span class="p">;</span><span class="w">        </span><span class="c1">//Polarization state anti-parallel of STT-MTJ</span>
<a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a><span class="kt">real</span><span class="w"> </span><span class="n">surface</span><span class="p">;</span><span class="w">       </span><span class="c1">//Surface of MTJ</span>
<a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a><span class="kt">real</span><span class="w"> </span><span class="n">gp</span><span class="p">;</span><span class="w">            </span><span class="c1">//Critical current density for P state </span>
<a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a><span class="kt">real</span><span class="w"> </span><span class="n">gap</span><span class="p">;</span><span class="w">           </span><span class="c1">//Critical current density for AP state</span>
<a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a><span class="kt">real</span><span class="w"> </span><span class="n">Em</span><span class="p">,</span><span class="n">EE</span><span class="p">;</span><span class="w">         </span><span class="c1">//Variable of the Slonczewski model</span>
<a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a><span class="kt">real</span><span class="w"> </span><span class="n">TMRR</span><span class="p">;</span><span class="w">          </span><span class="c1">//TMR real value for P state</span>
<a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a><span class="kt">real</span><span class="w"> </span><span class="n">TMRRT</span><span class="p">;</span><span class="w">         </span><span class="c1">//TMR real value for AP state</span>
<a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a><span class="kt">real</span><span class="w"> </span><span class="n">Ro</span><span class="p">;</span><span class="w">            </span><span class="c1">//Resistance of MTJ when bias voltage = 0V </span>
<a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a><span class="kt">real</span><span class="w"> </span><span class="n">Rap</span><span class="p">;</span><span class="w">           </span><span class="c1">//Resistance value for AP state </span>
<a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a><span class="kt">real</span><span class="w"> </span><span class="n">Rp</span><span class="p">;</span><span class="w">            </span><span class="c1">//Resistance value for P state</span>
<a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a><span class="c1">//Voltage of MTJ</span>
<a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a><span class="kt">real</span><span class="w"> </span><span class="n">Vb</span><span class="p">;</span><span class="w">            </span><span class="c1">//V(T1,T2) = V(T1) - V(T2)  When positive, it can switch P2AP </span>
<a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a><span class="kt">real</span><span class="w"> </span><span class="n">Vc</span><span class="p">;</span><span class="w">            </span><span class="c1">//V(T2,T1) = V(T2) - V(T1)  When positive, it can switch AP2P </span>
<a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a><span class="kt">real</span><span class="w"> </span><span class="n">Id</span><span class="p">;</span><span class="w">            </span><span class="c1">//Current of MTJ</span>
<a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a><span class="c1">//critial current for the two states of STT-MTJ</span>
<a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a><span class="kt">real</span><span class="w"> </span><span class="n">IcAP</span><span class="p">;</span><span class="w">          </span><span class="c1">//Critial current for AP state</span>
<a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a><span class="kt">real</span><span class="w"> </span><span class="n">IcP</span><span class="p">;</span><span class="w">           </span><span class="c1">//Critial current for P state</span>
<a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a><span class="kt">real</span><span class="w"> </span><span class="n">ix</span><span class="p">;</span><span class="w">            </span><span class="c1">//Current used to store the state of the MTJ (0: parallel, 1: anti-parllel) </span>
<a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a><span class="kt">real</span><span class="w"> </span><span class="n">tau</span><span class="p">;</span><span class="w">           </span><span class="c1">//Probability parameter</span>
<a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a><span class="kt">real</span><span class="w"> </span><span class="n">FA</span><span class="p">;</span><span class="w">            </span><span class="c1">//Factor for calculating the resistance based on RA</span>
<a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a><span class="cm">/*--------Stochastic effects--------------*/</span>
<a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a><span class="kt">real</span><span class="w"> </span><span class="n">durationstatic</span><span class="p">,</span><span class="w"> </span><span class="n">duration</span><span class="p">;</span><span class="w">      </span><span class="c1">//time needed to be sure that the switching is effected</span>
<a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a><span class="kt">real</span><span class="w"> </span><span class="n">toxreal</span><span class="p">;</span><span class="w">                       </span><span class="c1">//real thickness of oxide layer     </span>
<a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a><span class="kt">real</span><span class="w"> </span><span class="n">tslreal</span><span class="p">;</span><span class="w">                       </span><span class="c1">//real thickness of free layer      </span>
<a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a><span class="kt">real</span><span class="w"> </span><span class="n">TMRreal</span><span class="p">;</span><span class="w">                       </span><span class="c1">//real TMR</span>
<a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a><span class="k">parameter</span><span class="w"> </span><span class="k">integer</span><span class="w"> </span><span class="n">mtj_seed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w">     </span><span class="c1">// device-specific seed generated by python to be used for both variability and stochasti </span>
<a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a><span class="k">integer</span><span class="w"> </span><span class="n">seed1</span><span class="o">=</span><span class="mh">0</span><span class="p">;</span><span class="w">                    </span><span class="c1">// seed for process variability random distributions </span>
<a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a><span class="k">integer</span><span class="w"> </span><span class="n">seed2</span><span class="o">=</span><span class="mh">0</span><span class="p">;</span><span class="w">                    </span><span class="c1">// seed for stochasticity random distributions  </span>
<a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a><span class="cm">/*----------switching delay----------------*/</span>
<a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a><span class="kt">real</span><span class="w"> </span><span class="n">P_APt</span><span class="p">;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a><span class="kt">real</span><span class="w"> </span><span class="n">AP_Pt</span><span class="p">;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a><span class="kt">real</span><span class="w"> </span><span class="n">NP_APt</span><span class="p">,</span><span class="n">NAP_Pt</span><span class="p">;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a><span class="k">integer</span><span class="w"> </span><span class="n">counter</span><span class="p">;</span>
<a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a><span class="k">integer</span><span class="w"> </span><span class="n">fp</span><span class="p">;</span>
<a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a><span class="c1">//--------------------------------------------------------------------------------------------------------------------------------------//</span>
<a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a><span class="n">analog</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SHAPE</span><span class="o">==</span><span class="mh">1</span><span class="p">)</span><span class="w">               </span><span class="c1">//square</span>
<a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a><span class="k">begin</span>
<a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a><span class="w">    </span><span class="n">surface</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a><span class="k">end</span>
<a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SHAPE</span><span class="o">==</span><span class="mh">2</span><span class="p">)</span><span class="w">          </span><span class="c1">//ellipse (a/2 and b/2 are semi-minor &amp; semi-major)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a><span class="k">begin</span>
<a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a><span class="w">    </span><span class="n">surface</span><span class="o">=</span><span class="no">`M_PI</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">/</span><span class="mh">4</span><span class="p">;</span>
<a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a><span class="k">end</span>
<a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a><span class="k">else</span><span class="w">                        </span><span class="c1">// round</span>
<a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a><span class="k">begin</span>
<a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a><span class="w">    </span><span class="n">surface</span><span class="o">=</span><span class="no">`M_PI</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="p">;</span><span class="w">      </span>
<a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a><span class="k">end</span>
<a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a><span class="n">Vc</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span><span class="n">T1</span><span class="p">);</span>
<a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a><span class="n">Vb</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">);</span>
<a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a><span class="p">@(</span><span class="n">initial_step</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a><span class="w">    </span><span class="n">counter</span><span class="o">=</span><span class="mh">0</span><span class="p">;</span>
<a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a><span class="w">    </span><span class="n">FA</span><span class="o">=</span><span class="mf">3322.53</span><span class="o">/</span><span class="n">RA</span><span class="p">;</span><span class="w">              </span><span class="c1">// initialization of resistance factor according to RA product</span>
<a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a><span class="w">    </span><span class="n">seed1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtj_seed</span><span class="p">;</span><span class="w">           </span><span class="c1">// process variability MC</span>
<a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a><span class="w">    </span><span class="n">seed2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtj_seed</span><span class="p">;</span><span class="w">           </span><span class="c1">// stochasticity MC</span>
<a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RV</span><span class="o">==</span><span class="mh">1</span><span class="p">)</span><span class="w">                      </span><span class="c1">//real thinkness of oxide layer, free layer and real TMR with uniform dist variability</span>
<a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a><span class="w">    </span><span class="k">begin</span>
<a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a><span class="w">        </span><span class="n">toxreal</span><span class="o">=</span><span class="n">$rdist_uniform</span><span class="p">(</span><span class="n">seed1</span><span class="p">,(</span><span class="n">tox</span><span class="o">-</span><span class="n">tox</span><span class="o">*</span><span class="n">DEV_tox</span><span class="p">),(</span><span class="n">tox</span><span class="o">+</span><span class="n">tox</span><span class="o">*</span><span class="n">DEV_tox</span><span class="p">));</span>
<a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a><span class="w">        </span><span class="n">tslreal</span><span class="o">=</span><span class="n">$rdist_uniform</span><span class="p">(</span><span class="n">seed1</span><span class="p">,(</span><span class="n">tsl</span><span class="o">-</span><span class="n">tsl</span><span class="o">*</span><span class="n">DEV_tsl</span><span class="p">),(</span><span class="n">tsl</span><span class="o">+</span><span class="n">tsl</span><span class="o">*</span><span class="n">DEV_tsl</span><span class="p">));</span>
<a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a><span class="w">        </span><span class="n">TMRreal</span><span class="o">=</span><span class="n">$rdist_uniform</span><span class="p">(</span><span class="n">seed1</span><span class="p">,(</span><span class="n">TMR</span><span class="o">-</span><span class="n">TMR</span><span class="o">*</span><span class="n">DEV_TMR</span><span class="p">),(</span><span class="n">TMR</span><span class="o">+</span><span class="n">TMR</span><span class="o">*</span><span class="n">DEV_TMR</span><span class="p">));</span><span class="w">          </span>
<a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RV</span><span class="o">==</span><span class="mh">2</span><span class="p">)</span><span class="w">                 </span><span class="c1">//real thinkness of oxide layer, free layer and real TMR with gauss dist variability </span>
<a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a><span class="w">    </span><span class="k">begin</span>
<a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a><span class="w">        </span><span class="n">toxreal</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_normal</span><span class="p">(</span><span class="n">seed1</span><span class="p">,</span><span class="n">tox</span><span class="p">,</span><span class="n">tox</span><span class="o">*</span><span class="n">DEV_tox</span><span class="p">));</span>
<a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a><span class="w">        </span><span class="n">tslreal</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_normal</span><span class="p">(</span><span class="n">seed1</span><span class="p">,</span><span class="n">tsl</span><span class="p">,</span><span class="n">tsl</span><span class="o">*</span><span class="n">DEV_tsl</span><span class="p">));</span>
<a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a><span class="w">        </span><span class="n">TMRreal</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_normal</span><span class="p">(</span><span class="n">seed1</span><span class="p">,</span><span class="n">TMR</span><span class="p">,</span><span class="n">TMR</span><span class="o">*</span><span class="n">DEV_TMR</span><span class="p">));</span><span class="w">                                      </span>
<a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a><span class="w">    </span><span class="k">else</span>
<a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a><span class="w">    </span><span class="k">begin</span><span class="w">                           </span><span class="c1">// No variability </span>
<a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a><span class="w">        </span><span class="n">toxreal</span><span class="o">=</span><span class="n">tox</span><span class="p">;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a><span class="w">        </span><span class="n">tslreal</span><span class="o">=</span><span class="n">tsl</span><span class="p">;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a><span class="w">        </span><span class="n">TMRreal</span><span class="o">=</span><span class="n">TMR</span><span class="p">;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a><span class="w">    </span><span class="c1">// parameters for temperature</span>
<a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a><span class="w">    </span><span class="n">temp</span><span class="o">=</span><span class="n">T</span><span class="p">;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a><span class="w">    </span><span class="n">temp_init</span><span class="o">=</span><span class="n">T</span><span class="p">;</span><span class="w">    </span>
<a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a><span class="w">    </span><span class="n">tau_th</span><span class="o">=</span><span class="w"> </span><span class="n">Cv</span><span class="o">*</span><span class="n">thick_s</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">lam</span><span class="o">/</span><span class="n">thick_s</span><span class="p">);</span><span class="w"> </span>
<a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a><span class="w">    </span><span class="n">capacitor</span><span class="o">=</span><span class="n">coeff_tau</span><span class="o">*</span><span class="n">tau_th</span><span class="o">/</span><span class="n">resistor</span><span class="p">;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a><span class="w">    </span><span class="n">Ro</span><span class="o">=</span><span class="p">(</span><span class="n">toxreal</span><span class="o">*</span><span class="mf">1.0e10</span><span class="o">/</span><span class="p">(</span><span class="n">FA</span><span class="o">*</span><span class="no">`sqrt</span><span class="p">(</span><span class="n">PhiBas</span><span class="p">)</span><span class="o">*</span><span class="n">surface</span><span class="o">*</span><span class="mf">1.0e12</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.025</span><span class="o">*</span><span class="n">toxreal</span><span class="o">*</span><span class="mf">1.0e10</span><span class="o">*</span><span class="no">`sqrt</span><span class="p">(</span><span class="n">PhiBas</span><span class="p">));</span><span class="w">      </span><span class="c1">// Ro : Resistance of MTJ when bias voltage = 0V</span>
<a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a><span class="w">    </span><span class="c1">//parameters for calculating switching delay</span>
<a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a><span class="w">    </span><span class="n">Em</span><span class="o">=</span><span class="n">Ms</span><span class="o">*</span><span class="n">tslreal</span><span class="o">*</span><span class="n">surface</span><span class="o">*</span><span class="n">Hk</span><span class="o">/</span><span class="mh">2</span><span class="p">;</span><span class="w">      </span><span class="c1">// Em : Variable of the Slonczewski model</span>
<a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a><span class="w">    </span><span class="n">duration</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>
<a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a><span class="w">    </span><span class="n">P_APt</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a><span class="w">    </span><span class="n">AP_Pt</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a><span class="w">    </span><span class="n">NP_APt</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span>
<a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a><span class="w">    </span><span class="n">NAP_Pt</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span>
<a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">analysis</span><span class="p">(</span><span class="s">&quot;dc&quot;</span><span class="p">))</span><span class="w">  </span><span class="c1">//States inititialisation</span>
<a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a><span class="w">    </span><span class="k">begin</span>
<a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a><span class="w">        </span><span class="n">ix</span><span class="o">=</span><span class="n">PAP</span><span class="p">;</span><span class="w">         </span><span class="c1">// ix: Current used to store the state of the MTJ    </span>
<a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a><span class="w">    </span><span class="k">else</span>
<a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a><span class="w">    </span><span class="k">begin</span>
<a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a><span class="w">        </span><span class="n">ix</span><span class="o">=</span><span class="n">PAP</span><span class="p">;</span>
<a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a><span class="w">    </span><span class="k">end</span><span class="w"> </span>
<a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a><span class="k">end</span><span class="w">                     </span><span class="c1">//end of initial_step</span>
<a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a><span class="k">if</span><span class="p">(</span><span class="n">Temp_var</span><span class="o">==</span><span class="mh">0</span><span class="p">)</span><span class="w">         </span><span class="c1">//temperature is constant</span>
<a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a><span class="k">begin</span>
<a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a><span class="w">    </span><span class="n">temp</span><span class="o">=</span><span class="n">temp_init</span><span class="p">;</span><span class="w"> </span>
<a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a><span class="k">end</span>
<a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a><span class="k">else</span><span class="w">                    </span><span class="c1">//temperature actualisation</span>
<a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a><span class="k">begin</span>
<a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a><span class="w">    </span><span class="n">temp</span><span class="o">=</span><span class="n">V</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">temp_init</span><span class="p">;</span>
<a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a><span class="k">end</span><span class="w">      </span>
<a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a><span class="n">EE</span><span class="o">=</span><span class="n">Em</span><span class="o">/</span><span class="p">(</span><span class="no">`Kb</span><span class="o">*</span><span class="n">temp</span><span class="o">*</span><span class="mh">40</span><span class="o">*</span><span class="no">`M_PI</span><span class="p">);</span><span class="w">  </span>
<a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a><span class="cm">/*----calculation of real current------*/</span>
<a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a><span class="n">TMRR</span><span class="o">=</span><span class="n">TMRreal</span><span class="o">/</span><span class="p">(</span><span class="mh">1</span><span class="o">+</span><span class="n">Vb</span><span class="o">*</span><span class="n">Vb</span><span class="o">/</span><span class="p">(</span><span class="n">Vh</span><span class="o">*</span><span class="n">Vh</span><span class="p">));</span><span class="w"> </span>
<a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a><span class="n">Rp</span><span class="o">=</span><span class="n">Ro</span><span class="p">;</span>
<a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a><span class="n">Rap</span><span class="o">=</span><span class="n">Rp</span><span class="o">*</span><span class="p">(</span><span class="mh">1</span><span class="o">+</span><span class="n">TMRR</span><span class="p">);</span>
<a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a><span class="k">if</span><span class="p">(</span><span class="n">ix</span><span class="o">==</span><span class="mh">0</span><span class="p">)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a><span class="k">begin</span>
<a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a><span class="w">    </span><span class="n">R</span><span class="o">=</span><span class="n">Rp</span><span class="p">;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a><span class="k">end</span>
<a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a><span class="k">else</span><span class="w">    </span><span class="c1">//ie: ix=1 if dc and ix =-1 for tran</span>
<a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a><span class="k">begin</span>
<a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a><span class="w">    </span><span class="n">R</span><span class="o">=</span><span class="n">Rap</span><span class="p">;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a><span class="k">end</span>
<a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a><span class="n">Id</span><span class="o">=</span><span class="n">Vb</span><span class="o">/</span><span class="n">R</span><span class="p">;</span>
<a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a><span class="cm">/*----calculation of rcritical current------*/</span>
<a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a><span class="n">PolaP</span><span class="o">=</span><span class="no">`sqrt</span><span class="p">(</span><span class="n">TMRreal</span><span class="o">*</span><span class="p">(</span><span class="n">TMRreal</span><span class="o">+</span><span class="mh">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mh">2</span><span class="o">*</span><span class="p">(</span><span class="n">TMRreal</span><span class="o">+</span><span class="mh">1</span><span class="p">));</span><span class="w">           </span><span class="c1">//Polarization state parallel</span>
<a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a><span class="n">gp</span><span class="o">=</span><span class="n">alpha</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="no">`e</span><span class="o">*</span><span class="n">Ms</span><span class="o">*</span><span class="n">tslreal</span><span class="o">*</span><span class="n">Hk</span><span class="o">/</span><span class="p">(</span><span class="mh">40</span><span class="o">*</span><span class="no">`M_PI</span><span class="o">*</span><span class="p">(</span><span class="no">`ub</span><span class="o">*</span><span class="n">PolaP</span><span class="p">));</span><span class="w">     </span><span class="c1">//Critical current density    </span>
<a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a><span class="n">IcP</span><span class="o">=</span><span class="n">gp</span><span class="o">*</span><span class="n">surface</span><span class="p">;</span><span class="w">                                             </span><span class="c1">// Critical current for P state</span>
<a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a><span class="n">PolaAP</span><span class="o">=</span><span class="no">`sqrt</span><span class="p">(</span><span class="n">TMRreal</span><span class="o">*</span><span class="p">(</span><span class="n">TMRreal</span><span class="o">+</span><span class="mh">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mh">2</span><span class="o">*</span><span class="p">(</span><span class="n">TMRreal</span><span class="o">+</span><span class="mh">1</span><span class="p">));</span><span class="w">          </span><span class="c1">//Polarization state anti-parallel  </span>
<a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a><span class="n">gap</span><span class="o">=</span><span class="n">alpha</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="no">`e</span><span class="o">*</span><span class="n">Ms</span><span class="o">*</span><span class="n">tslreal</span><span class="o">*</span><span class="n">Hk</span><span class="o">/</span><span class="p">(</span><span class="mh">40</span><span class="o">*</span><span class="no">`M_PI</span><span class="o">*</span><span class="p">(</span><span class="no">`ub</span><span class="o">*</span><span class="n">PolaAP</span><span class="p">));</span><span class="w">   </span><span class="c1">//Critical current density  </span>
<a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a><span class="n">IcAP</span><span class="o">=</span><span class="n">gap</span><span class="o">*</span><span class="n">surface</span><span class="p">;</span><span class="w">                                           </span><span class="c1">// Critical current for AP state         </span>
<a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a><span class="cm">/*------Counter of time when real current is higher than critical current */</span>
<a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a><span class="p">@(</span><span class="n">above</span><span class="p">(</span><span class="n">Id</span><span class="o">-</span><span class="n">IcP</span><span class="p">,</span><span class="o">+</span><span class="mh">1</span><span class="p">))</span><span class="w">   </span>
<a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a><span class="k">begin</span>
<a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a><span class="w">    </span><span class="n">P_APt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">$abstime</span><span class="p">;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a><span class="w">    </span><span class="n">NP_APt</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span><span class="w">     </span>
<a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a><span class="k">end</span>
<a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a><span class="p">@(</span><span class="n">above</span><span class="p">(</span><span class="o">-</span><span class="n">Id</span><span class="o">-</span><span class="n">IcAP</span><span class="p">,</span><span class="o">+</span><span class="mh">1</span><span class="p">))</span>
<a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a><span class="k">begin</span>
<a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a><span class="w">    </span><span class="n">AP_Pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">$abstime</span><span class="p">;</span>
<a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a><span class="w">    </span><span class="n">NAP_Pt</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span><span class="w">     </span>
<a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a><span class="k">end</span>
<a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a><span class="p">@(</span><span class="n">above</span><span class="p">(</span><span class="n">Vb</span><span class="o">-</span><span class="n">brown_threshold_P2AP</span><span class="p">,</span><span class="o">+</span><span class="mh">1</span><span class="p">))</span>
<a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a><span class="k">begin</span>
<a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a><span class="w">    </span><span class="n">NP_APt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">$abstime</span><span class="p">;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a><span class="w">    </span><span class="n">AP_Pt</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span>
<a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a><span class="w">    </span><span class="n">NAP_Pt</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span><span class="w"> </span>
<a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a><span class="k">end</span>
<a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a><span class="p">@(</span><span class="n">above</span><span class="p">(</span><span class="n">Vc</span><span class="o">-</span><span class="n">brown_threshold_AP2P</span><span class="p">,</span><span class="o">+</span><span class="mh">1</span><span class="p">))</span>
<a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a><span class="k">begin</span>
<a id="__codelineno-0-313" name="__codelineno-0-313" href="#__codelineno-0-313"></a><span class="w">    </span><span class="n">NAP_Pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">$abstime</span><span class="p">;</span>
<a id="__codelineno-0-314" name="__codelineno-0-314" href="#__codelineno-0-314"></a><span class="w">    </span><span class="n">P_APt</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span>
<a id="__codelineno-0-315" name="__codelineno-0-315" href="#__codelineno-0-315"></a><span class="w">    </span><span class="n">NP_APt</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span><span class="w">     </span>
<a id="__codelineno-0-316" name="__codelineno-0-316" href="#__codelineno-0-316"></a><span class="k">end</span>
<a id="__codelineno-0-317" name="__codelineno-0-317" href="#__codelineno-0-317"></a><span class="c1">//-------------------</span>
<a id="__codelineno-0-318" name="__codelineno-0-318" href="#__codelineno-0-318"></a><span class="k">if</span><span class="p">(</span><span class="n">analysis</span><span class="p">(</span><span class="s">&quot;dc&quot;</span><span class="p">))</span><span class="w">                   </span><span class="c1">// dc analysis                 </span>
<a id="__codelineno-0-319" name="__codelineno-0-319" href="#__codelineno-0-319"></a><span class="k">begin</span><span class="w">   </span>
<a id="__codelineno-0-320" name="__codelineno-0-320" href="#__codelineno-0-320"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ix</span><span class="o">==</span><span class="mh">0</span><span class="p">)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321" href="#__codelineno-0-321"></a><span class="w">    </span><span class="k">begin</span>
<a id="__codelineno-0-322" name="__codelineno-0-322" href="#__codelineno-0-322"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">Vb</span><span class="o">&gt;=</span><span class="p">(</span><span class="n">IcP</span><span class="o">*</span><span class="n">Rp</span><span class="p">))</span><span class="w">        </span>
<a id="__codelineno-0-323" name="__codelineno-0-323" href="#__codelineno-0-323"></a><span class="w">        </span><span class="k">begin</span>
<a id="__codelineno-0-324" name="__codelineno-0-324" href="#__codelineno-0-324"></a><span class="w">            </span><span class="n">ix</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325" href="#__codelineno-0-325"></a><span class="w">        </span><span class="k">end</span>
<a id="__codelineno-0-326" name="__codelineno-0-326" href="#__codelineno-0-326"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-0-327" name="__codelineno-0-327" href="#__codelineno-0-327"></a><span class="w">    </span><span class="k">else</span><span class="w">    </span><span class="c1">//(ix==1)</span>
<a id="__codelineno-0-328" name="__codelineno-0-328" href="#__codelineno-0-328"></a><span class="w">    </span><span class="k">begin</span><span class="w">               </span>
<a id="__codelineno-0-329" name="__codelineno-0-329" href="#__codelineno-0-329"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">Vc</span><span class="o">&gt;=</span><span class="p">(</span><span class="n">IcAP</span><span class="o">*</span><span class="n">Rap</span><span class="p">))</span>
<a id="__codelineno-0-330" name="__codelineno-0-330" href="#__codelineno-0-330"></a><span class="w">        </span><span class="k">begin</span>
<a id="__codelineno-0-331" name="__codelineno-0-331" href="#__codelineno-0-331"></a><span class="w">            </span><span class="n">ix</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332" href="#__codelineno-0-332"></a><span class="w">        </span><span class="k">end</span>
<a id="__codelineno-0-333" name="__codelineno-0-333" href="#__codelineno-0-333"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-0-334" name="__codelineno-0-334" href="#__codelineno-0-334"></a><span class="w">    </span><span class="n">I</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">)</span><span class="o">&lt;+</span><span class="n">Id</span><span class="p">;</span><span class="w">                       </span><span class="c1">//Actualisation of the current of MTJ with the value calculated</span>
<a id="__codelineno-0-335" name="__codelineno-0-335" href="#__codelineno-0-335"></a><span class="k">end</span><span class="w">             </span>
<a id="__codelineno-0-336" name="__codelineno-0-336" href="#__codelineno-0-336"></a><span class="c1">//------------------------------------------------------------------------------------------------------------------------------</span>
<a id="__codelineno-0-337" name="__codelineno-0-337" href="#__codelineno-0-337"></a><span class="k">else</span><span class="w">                                    </span><span class="c1">// transient analysis                 </span>
<a id="__codelineno-0-338" name="__codelineno-0-338" href="#__codelineno-0-338"></a><span class="k">begin</span>
<a id="__codelineno-0-339" name="__codelineno-0-339" href="#__codelineno-0-339"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ix</span><span class="o">==</span><span class="mh">0</span><span class="p">)</span><span class="w">                       </span><span class="c1">// parallel state</span>
<a id="__codelineno-0-340" name="__codelineno-0-340" href="#__codelineno-0-340"></a><span class="w">    </span><span class="k">begin</span><span class="w">   </span>
<a id="__codelineno-0-341" name="__codelineno-0-341" href="#__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342" href="#__codelineno-0-342"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">Vb</span><span class="o">&gt;=</span><span class="n">IcP</span><span class="o">*</span><span class="n">Rp</span><span class="p">)</span><span class="w">              </span><span class="c1">//Current higher than critical current, dynamic behavior: Sun model </span>
<a id="__codelineno-0-343" name="__codelineno-0-343" href="#__codelineno-0-343"></a><span class="w">        </span><span class="k">begin</span>
<a id="__codelineno-0-344" name="__codelineno-0-344" href="#__codelineno-0-344"></a><span class="w">            </span><span class="n">durationstatic</span><span class="o">=</span><span class="p">(</span><span class="no">`C</span><span class="o">+</span><span class="n">ln</span><span class="p">(</span><span class="no">`M_PI</span><span class="o">*</span><span class="no">`M_PI</span><span class="o">*</span><span class="p">(</span><span class="n">Em</span><span class="o">/</span><span class="p">(</span><span class="no">`Kb</span><span class="o">*</span><span class="n">temp</span><span class="o">*</span><span class="mh">40</span><span class="o">*</span><span class="no">`M_PI</span><span class="p">))</span><span class="o">/</span><span class="mh">4</span><span class="p">))</span><span class="o">*</span><span class="no">`e</span><span class="o">*</span><span class="mh">1000</span><span class="o">*</span><span class="n">Ms</span><span class="o">*</span><span class="n">surface</span><span class="o">*</span><span class="n">tslreal</span><span class="o">*</span><span class="p">(</span><span class="mh">1</span><span class="o">+</span><span class="n">P</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mh">4</span><span class="o">*</span><span class="no">`M_PI</span><span class="o">*</span><span class="mh">2</span><span class="o">*</span><span class="no">`ub</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mh">10000</span><span class="o">*</span><span class="n">abs</span><span class="p">(</span><span class="n">Id</span><span class="o">-</span><span class="n">IcP</span><span class="p">));</span><span class="w">  </span><span class="c1">//Average time needed for switching</span>
<a id="__codelineno-0-345" name="__codelineno-0-345" href="#__codelineno-0-345"></a><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">STO</span><span class="o">==</span><span class="mh">1</span><span class="p">)</span><span class="w">              </span><span class="c1">//parallel -- Vb &gt; Icp *Rp -- expon_ stochast</span>
<a id="__codelineno-0-346" name="__codelineno-0-346" href="#__codelineno-0-346"></a><span class="w">            </span><span class="k">begin</span>
<a id="__codelineno-0-347" name="__codelineno-0-347" href="#__codelineno-0-347"></a><span class="w">                </span><span class="n">duration</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_exponential</span><span class="p">(</span><span class="n">seed2</span><span class="p">,</span><span class="w"> </span><span class="n">durationstatic</span><span class="p">));</span><span class="w"> </span>
<a id="__codelineno-0-348" name="__codelineno-0-348" href="#__codelineno-0-348"></a><span class="w">            </span><span class="k">end</span>
<a id="__codelineno-0-349" name="__codelineno-0-349" href="#__codelineno-0-349"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">STO</span><span class="o">==</span><span class="mh">2</span><span class="p">)</span><span class="w">         </span><span class="c1">//parallel -- Vb &gt; Icp *Rp -- normal_ stochast</span>
<a id="__codelineno-0-350" name="__codelineno-0-350" href="#__codelineno-0-350"></a><span class="w">            </span><span class="k">begin</span><span class="w">                     </span>
<a id="__codelineno-0-351" name="__codelineno-0-351" href="#__codelineno-0-351"></a><span class="w">                </span><span class="n">duration</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_normal</span><span class="p">(</span><span class="n">seed2</span><span class="p">,</span><span class="n">durationstatic</span><span class="p">,</span><span class="n">durationstatic</span><span class="o">*</span><span class="n">STO_dev</span><span class="p">));</span>
<a id="__codelineno-0-352" name="__codelineno-0-352" href="#__codelineno-0-352"></a><span class="w">            </span><span class="k">end</span><span class="w"> </span>
<a id="__codelineno-0-353" name="__codelineno-0-353" href="#__codelineno-0-353"></a><span class="w">            </span><span class="k">else</span><span class="w">                    </span><span class="c1">//parallel -- Vb &gt; Icp *Rp -- NO stochast</span>
<a id="__codelineno-0-354" name="__codelineno-0-354" href="#__codelineno-0-354"></a><span class="w">            </span><span class="k">begin</span><span class="w">           </span>
<a id="__codelineno-0-355" name="__codelineno-0-355" href="#__codelineno-0-355"></a><span class="w">                </span><span class="n">duration</span><span class="o">=</span><span class="n">durationstatic</span><span class="p">;</span>
<a id="__codelineno-0-356" name="__codelineno-0-356" href="#__codelineno-0-356"></a><span class="w">            </span><span class="k">end</span><span class="w">                         </span>
<a id="__codelineno-0-357" name="__codelineno-0-357" href="#__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358" href="#__codelineno-0-358"></a><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">duration</span><span class="o">&lt;=</span><span class="p">(</span><span class="n">$abstime</span><span class="o">-</span><span class="n">P_APt</span><span class="p">))</span><span class="w">  </span><span class="c1">// duration is enough to switch  //Switching of the free layer always occurs</span>
<a id="__codelineno-0-359" name="__codelineno-0-359" href="#__codelineno-0-359"></a><span class="w">            </span><span class="k">begin</span>
<a id="__codelineno-0-360" name="__codelineno-0-360" href="#__codelineno-0-360"></a><span class="w">                </span><span class="n">ix</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span><span class="w">      </span><span class="c1">// change of the current state of MTJ  </span>
<a id="__codelineno-0-361" name="__codelineno-0-361" href="#__codelineno-0-361"></a><span class="w">            </span><span class="k">end</span>
<a id="__codelineno-0-362" name="__codelineno-0-362" href="#__codelineno-0-362"></a><span class="w">            </span><span class="k">else</span>
<a id="__codelineno-0-363" name="__codelineno-0-363" href="#__codelineno-0-363"></a><span class="w">            </span><span class="k">begin</span>
<a id="__codelineno-0-364" name="__codelineno-0-364" href="#__codelineno-0-364"></a><span class="w">                </span><span class="n">ix</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365" href="#__codelineno-0-365"></a><span class="w">            </span><span class="k">end</span>
<a id="__codelineno-0-366" name="__codelineno-0-366" href="#__codelineno-0-366"></a><span class="w">        </span><span class="k">end</span>
<a id="__codelineno-0-367" name="__codelineno-0-367" href="#__codelineno-0-367"></a><span class="w">        </span><span class="k">else</span><span class="w">                        </span><span class="c1">// current smaller than critical current : Neel-Brown model</span>
<a id="__codelineno-0-368" name="__codelineno-0-368" href="#__codelineno-0-368"></a>
<a id="__codelineno-0-369" name="__codelineno-0-369" href="#__codelineno-0-369"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">Vb</span><span class="o">&gt;</span><span class="n">brown_threshold_P2AP</span><span class="p">)</span><span class="w"> </span><span class="c1">//added</span>
<a id="__codelineno-0-370" name="__codelineno-0-370" href="#__codelineno-0-370"></a><span class="w">        </span><span class="k">begin</span>
<a id="__codelineno-0-371" name="__codelineno-0-371" href="#__codelineno-0-371"></a><span class="w">            </span><span class="n">ix</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>
<a id="__codelineno-0-372" name="__codelineno-0-372" href="#__codelineno-0-372"></a><span class="w">            </span><span class="n">tau</span><span class="o">=</span><span class="n">tau0</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Em</span><span class="o">*</span><span class="p">(</span><span class="mh">1</span><span class="o">-</span><span class="n">abs</span><span class="p">(</span><span class="n">Id</span><span class="o">/</span><span class="n">IcP</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="no">`Kb</span><span class="o">*</span><span class="n">temp</span><span class="o">*</span><span class="mh">40</span><span class="o">*</span><span class="no">`M_PI</span><span class="p">));</span><span class="w">   </span>
<a id="__codelineno-0-373" name="__codelineno-0-373" href="#__codelineno-0-373"></a><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">Vb</span><span class="o">&gt;</span><span class="n">brown_threshold_P2AP</span><span class="p">)</span><span class="w"> </span>
<a id="__codelineno-0-374" name="__codelineno-0-374" href="#__codelineno-0-374"></a><span class="w">            </span><span class="k">begin</span>
<a id="__codelineno-0-375" name="__codelineno-0-375" href="#__codelineno-0-375"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Vb</span><span class="o">&lt;</span><span class="mf">0.8</span><span class="o">*</span><span class="n">IcP</span><span class="o">*</span><span class="n">Rp</span><span class="p">)</span>
<a id="__codelineno-0-376" name="__codelineno-0-376" href="#__codelineno-0-376"></a><span class="w">                </span><span class="k">begin</span>
<a id="__codelineno-0-377" name="__codelineno-0-377" href="#__codelineno-0-377"></a><span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">STO</span><span class="o">==</span><span class="mh">1</span><span class="p">)</span><span class="w"> </span>
<a id="__codelineno-0-378" name="__codelineno-0-378" href="#__codelineno-0-378"></a><span class="w">                    </span><span class="k">begin</span>
<a id="__codelineno-0-379" name="__codelineno-0-379" href="#__codelineno-0-379"></a><span class="w">                        </span><span class="n">duration</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_exponential</span><span class="p">(</span><span class="n">seed2</span><span class="p">,</span><span class="w"> </span><span class="n">tau</span><span class="p">));</span>
<a id="__codelineno-0-380" name="__codelineno-0-380" href="#__codelineno-0-380"></a><span class="w">                    </span><span class="k">end</span>
<a id="__codelineno-0-381" name="__codelineno-0-381" href="#__codelineno-0-381"></a><span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">STO</span><span class="o">==</span><span class="mh">2</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382" href="#__codelineno-0-382"></a><span class="w">                    </span><span class="k">begin</span>
<a id="__codelineno-0-383" name="__codelineno-0-383" href="#__codelineno-0-383"></a><span class="w">                        </span><span class="n">duration</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_normal</span><span class="p">(</span><span class="n">seed2</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="n">tau</span><span class="o">*</span><span class="n">STO_dev</span><span class="p">));</span>
<a id="__codelineno-0-384" name="__codelineno-0-384" href="#__codelineno-0-384"></a><span class="w">                    </span><span class="k">end</span><span class="w">     </span>
<a id="__codelineno-0-385" name="__codelineno-0-385" href="#__codelineno-0-385"></a><span class="w">                    </span><span class="k">else</span>
<a id="__codelineno-0-386" name="__codelineno-0-386" href="#__codelineno-0-386"></a><span class="w">                    </span><span class="k">begin</span>
<a id="__codelineno-0-387" name="__codelineno-0-387" href="#__codelineno-0-387"></a><span class="w">                        </span><span class="n">duration</span><span class="o">=</span><span class="n">tau</span><span class="p">;</span><span class="w">           </span>
<a id="__codelineno-0-388" name="__codelineno-0-388" href="#__codelineno-0-388"></a><span class="w">                    </span><span class="k">end</span><span class="w">                                     </span>
<a id="__codelineno-0-389" name="__codelineno-0-389" href="#__codelineno-0-389"></a><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">$abstime</span><span class="o">-</span><span class="n">NP_APt</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">duration</span><span class="p">)</span><span class="w">  </span>
<a id="__codelineno-0-390" name="__codelineno-0-390" href="#__codelineno-0-390"></a><span class="w">                    </span><span class="k">begin</span>
<a id="__codelineno-0-391" name="__codelineno-0-391" href="#__codelineno-0-391"></a><span class="w">                        </span><span class="n">ix</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span><span class="w">  </span>
<a id="__codelineno-0-392" name="__codelineno-0-392" href="#__codelineno-0-392"></a><span class="w">                    </span><span class="k">end</span>
<a id="__codelineno-0-393" name="__codelineno-0-393" href="#__codelineno-0-393"></a><span class="w">                    </span><span class="k">else</span>
<a id="__codelineno-0-394" name="__codelineno-0-394" href="#__codelineno-0-394"></a><span class="w">                    </span><span class="k">begin</span>
<a id="__codelineno-0-395" name="__codelineno-0-395" href="#__codelineno-0-395"></a><span class="w">                        </span><span class="n">ix</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396" href="#__codelineno-0-396"></a><span class="w">                    </span><span class="k">end</span>
<a id="__codelineno-0-397" name="__codelineno-0-397" href="#__codelineno-0-397"></a><span class="w">                </span><span class="k">end</span><span class="w">             </span>
<a id="__codelineno-0-398" name="__codelineno-0-398" href="#__codelineno-0-398"></a><span class="w">            </span><span class="k">end</span><span class="w">     </span>
<a id="__codelineno-0-399" name="__codelineno-0-399" href="#__codelineno-0-399"></a><span class="w">        </span><span class="k">end</span>
<a id="__codelineno-0-400" name="__codelineno-0-400" href="#__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401" href="#__codelineno-0-401"></a><span class="w">    </span><span class="k">end</span><span class="w">         </span><span class="c1">// end of parallel state</span>
<a id="__codelineno-0-402" name="__codelineno-0-402" href="#__codelineno-0-402"></a><span class="w">    </span><span class="c1">//-----------------------------------------------------------------------------     </span>
<a id="__codelineno-0-403" name="__codelineno-0-403" href="#__codelineno-0-403"></a><span class="w">    </span><span class="k">else</span><span class="w">       </span><span class="c1">// initial state anti-parallel</span>
<a id="__codelineno-0-404" name="__codelineno-0-404" href="#__codelineno-0-404"></a><span class="w">    </span><span class="k">begin</span>
<a id="__codelineno-0-405" name="__codelineno-0-405" href="#__codelineno-0-405"></a>
<a id="__codelineno-0-406" name="__codelineno-0-406" href="#__codelineno-0-406"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">Vc</span><span class="o">&gt;=</span><span class="p">(</span><span class="n">IcAP</span><span class="o">*</span><span class="n">Rap</span><span class="p">))</span><span class="w"> </span><span class="c1">// anti-parallel, current higher than critical current: Sun model</span>
<a id="__codelineno-0-407" name="__codelineno-0-407" href="#__codelineno-0-407"></a><span class="w">        </span><span class="k">begin</span>
<a id="__codelineno-0-408" name="__codelineno-0-408" href="#__codelineno-0-408"></a><span class="w">            </span><span class="n">durationstatic</span><span class="o">=</span><span class="p">(</span><span class="no">`C</span><span class="o">+</span><span class="n">ln</span><span class="p">(</span><span class="no">`M_PI</span><span class="o">*</span><span class="no">`M_PI</span><span class="o">*</span><span class="p">(</span><span class="n">Em</span><span class="o">/</span><span class="p">(</span><span class="no">`Kb</span><span class="o">*</span><span class="n">temp</span><span class="o">*</span><span class="mh">40</span><span class="o">*</span><span class="no">`M_PI</span><span class="p">))</span><span class="o">/</span><span class="mh">4</span><span class="p">))</span><span class="o">*</span><span class="no">`e</span><span class="o">*</span><span class="mh">1000</span><span class="o">*</span><span class="n">Ms</span><span class="o">*</span><span class="n">surface</span><span class="o">*</span><span class="n">tslreal</span><span class="o">*</span><span class="p">(</span><span class="mh">1</span><span class="o">+</span><span class="n">P</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mh">4</span><span class="o">*</span><span class="no">`M_PI</span><span class="o">*</span><span class="mh">2</span><span class="o">*</span><span class="no">`ub</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mh">10000</span><span class="o">*</span><span class="n">abs</span><span class="p">(</span><span class="o">-</span><span class="n">Id</span><span class="o">-</span><span class="n">IcAP</span><span class="p">));</span>
<a id="__codelineno-0-409" name="__codelineno-0-409" href="#__codelineno-0-409"></a><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">STO</span><span class="o">==</span><span class="mh">1</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410" href="#__codelineno-0-410"></a><span class="w">            </span><span class="k">begin</span>
<a id="__codelineno-0-411" name="__codelineno-0-411" href="#__codelineno-0-411"></a><span class="w">                </span><span class="n">duration</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_exponential</span><span class="p">(</span><span class="n">seed2</span><span class="p">,</span><span class="w"> </span><span class="n">durationstatic</span><span class="p">));</span>
<a id="__codelineno-0-412" name="__codelineno-0-412" href="#__codelineno-0-412"></a><span class="w">            </span><span class="k">end</span>
<a id="__codelineno-0-413" name="__codelineno-0-413" href="#__codelineno-0-413"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">STO</span><span class="o">==</span><span class="mh">2</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414" href="#__codelineno-0-414"></a><span class="w">            </span><span class="k">begin</span>
<a id="__codelineno-0-415" name="__codelineno-0-415" href="#__codelineno-0-415"></a><span class="w">                </span><span class="n">duration</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_normal</span><span class="p">(</span><span class="n">seed2</span><span class="p">,</span><span class="n">durationstatic</span><span class="p">,</span><span class="n">durationstatic</span><span class="o">*</span><span class="n">STO_dev</span><span class="p">));</span><span class="w">       </span>
<a id="__codelineno-0-416" name="__codelineno-0-416" href="#__codelineno-0-416"></a><span class="w">            </span><span class="k">end</span>
<a id="__codelineno-0-417" name="__codelineno-0-417" href="#__codelineno-0-417"></a><span class="w">            </span><span class="k">else</span>
<a id="__codelineno-0-418" name="__codelineno-0-418" href="#__codelineno-0-418"></a><span class="w">            </span><span class="k">begin</span>
<a id="__codelineno-0-419" name="__codelineno-0-419" href="#__codelineno-0-419"></a><span class="w">                </span><span class="n">duration</span><span class="o">=</span><span class="n">durationstatic</span><span class="p">;</span>
<a id="__codelineno-0-420" name="__codelineno-0-420" href="#__codelineno-0-420"></a><span class="w">            </span><span class="k">end</span>
<a id="__codelineno-0-421" name="__codelineno-0-421" href="#__codelineno-0-421"></a><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">duration</span><span class="o">&lt;=</span><span class="p">(</span><span class="n">$abstime</span><span class="o">-</span><span class="n">AP_Pt</span><span class="p">))</span>
<a id="__codelineno-0-422" name="__codelineno-0-422" href="#__codelineno-0-422"></a><span class="w">            </span><span class="k">begin</span>
<a id="__codelineno-0-423" name="__codelineno-0-423" href="#__codelineno-0-423"></a><span class="w">                </span><span class="n">ix</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w">     </span>
<a id="__codelineno-0-424" name="__codelineno-0-424" href="#__codelineno-0-424"></a><span class="w">            </span><span class="k">end</span><span class="w"> </span>
<a id="__codelineno-0-425" name="__codelineno-0-425" href="#__codelineno-0-425"></a><span class="w">            </span><span class="k">else</span><span class="w">        </span><span class="c1">// duration is not enough to switch</span>
<a id="__codelineno-0-426" name="__codelineno-0-426" href="#__codelineno-0-426"></a><span class="w">            </span><span class="k">begin</span>
<a id="__codelineno-0-427" name="__codelineno-0-427" href="#__codelineno-0-427"></a><span class="w">                </span><span class="n">ix</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span>
<a id="__codelineno-0-428" name="__codelineno-0-428" href="#__codelineno-0-428"></a><span class="w">            </span><span class="k">end</span>
<a id="__codelineno-0-429" name="__codelineno-0-429" href="#__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430" href="#__codelineno-0-430"></a><span class="w">        </span><span class="k">end</span><span class="w">         </span>
<a id="__codelineno-0-431" name="__codelineno-0-431" href="#__codelineno-0-431"></a><span class="w">        </span><span class="k">else</span><span class="w">            </span><span class="c1">// trans - stochastic - anti-parallel - Neel Brwon </span>
<a id="__codelineno-0-432" name="__codelineno-0-432" href="#__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433" href="#__codelineno-0-433"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">Vc</span><span class="o">&gt;</span><span class="n">brown_threshold_AP2P</span><span class="p">)</span><span class="w"> </span><span class="c1">//added</span>
<a id="__codelineno-0-434" name="__codelineno-0-434" href="#__codelineno-0-434"></a><span class="w">        </span><span class="k">begin</span>
<a id="__codelineno-0-435" name="__codelineno-0-435" href="#__codelineno-0-435"></a><span class="w">            </span><span class="n">tau</span><span class="o">=</span><span class="n">tau0</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Em</span><span class="o">*</span><span class="p">(</span><span class="mh">1</span><span class="o">-</span><span class="n">abs</span><span class="p">(</span><span class="n">Id</span><span class="o">/</span><span class="n">IcAP</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="no">`Kb</span><span class="o">*</span><span class="n">temp</span><span class="o">*</span><span class="mh">40</span><span class="o">*</span><span class="no">`M_PI</span><span class="p">));</span>
<a id="__codelineno-0-436" name="__codelineno-0-436" href="#__codelineno-0-436"></a><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">Vc</span><span class="o">&gt;</span><span class="n">brown_threshold_AP2P</span><span class="p">)</span><span class="w"> </span>
<a id="__codelineno-0-437" name="__codelineno-0-437" href="#__codelineno-0-437"></a><span class="w">            </span><span class="k">begin</span>
<a id="__codelineno-0-438" name="__codelineno-0-438" href="#__codelineno-0-438"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Vc</span><span class="o">&lt;</span><span class="mf">0.8</span><span class="o">*</span><span class="n">IcAP</span><span class="o">*</span><span class="n">Rap</span><span class="p">)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439" href="#__codelineno-0-439"></a><span class="w">                </span><span class="k">begin</span>
<a id="__codelineno-0-440" name="__codelineno-0-440" href="#__codelineno-0-440"></a><span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">STO</span><span class="o">==</span><span class="mh">1</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441" href="#__codelineno-0-441"></a><span class="w">                    </span><span class="k">begin</span><span class="w">               </span>
<a id="__codelineno-0-442" name="__codelineno-0-442" href="#__codelineno-0-442"></a><span class="w">                        </span><span class="n">duration</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_exponential</span><span class="p">(</span><span class="n">seed2</span><span class="p">,</span><span class="w"> </span><span class="n">tau</span><span class="p">));</span>
<a id="__codelineno-0-443" name="__codelineno-0-443" href="#__codelineno-0-443"></a><span class="w">                    </span><span class="k">end</span>
<a id="__codelineno-0-444" name="__codelineno-0-444" href="#__codelineno-0-444"></a><span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">STO</span><span class="o">==</span><span class="mh">2</span><span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445" href="#__codelineno-0-445"></a><span class="w">                    </span><span class="k">begin</span>
<a id="__codelineno-0-446" name="__codelineno-0-446" href="#__codelineno-0-446"></a><span class="w">                        </span><span class="n">duration</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">$rdist_normal</span><span class="p">(</span><span class="n">seed2</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="n">tau</span><span class="o">*</span><span class="n">STO_dev</span><span class="p">));</span>
<a id="__codelineno-0-447" name="__codelineno-0-447" href="#__codelineno-0-447"></a><span class="w">                    </span><span class="k">end</span><span class="w">                 </span>
<a id="__codelineno-0-448" name="__codelineno-0-448" href="#__codelineno-0-448"></a><span class="w">                    </span><span class="k">else</span>
<a id="__codelineno-0-449" name="__codelineno-0-449" href="#__codelineno-0-449"></a><span class="w">                    </span><span class="k">begin</span>
<a id="__codelineno-0-450" name="__codelineno-0-450" href="#__codelineno-0-450"></a><span class="w">                        </span><span class="n">duration</span><span class="o">=</span><span class="n">tau</span><span class="p">;</span>
<a id="__codelineno-0-451" name="__codelineno-0-451" href="#__codelineno-0-451"></a><span class="w">                    </span><span class="k">end</span><span class="w"> </span>
<a id="__codelineno-0-452" name="__codelineno-0-452" href="#__codelineno-0-452"></a><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">duration</span><span class="o">&lt;=</span><span class="p">(</span><span class="n">$abstime</span><span class="o">-</span><span class="n">NAP_Pt</span><span class="p">))</span>
<a id="__codelineno-0-453" name="__codelineno-0-453" href="#__codelineno-0-453"></a><span class="w">                    </span><span class="k">begin</span><span class="w"> </span>
<a id="__codelineno-0-454" name="__codelineno-0-454" href="#__codelineno-0-454"></a><span class="w">                        </span><span class="n">ix</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span>
<a id="__codelineno-0-455" name="__codelineno-0-455" href="#__codelineno-0-455"></a><span class="w">                    </span><span class="k">end</span>
<a id="__codelineno-0-456" name="__codelineno-0-456" href="#__codelineno-0-456"></a><span class="w">                    </span><span class="k">else</span>
<a id="__codelineno-0-457" name="__codelineno-0-457" href="#__codelineno-0-457"></a><span class="w">                    </span><span class="k">begin</span>
<a id="__codelineno-0-458" name="__codelineno-0-458" href="#__codelineno-0-458"></a><span class="w">                        </span><span class="n">ix</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span>
<a id="__codelineno-0-459" name="__codelineno-0-459" href="#__codelineno-0-459"></a><span class="w">                    </span><span class="k">end</span>
<a id="__codelineno-0-460" name="__codelineno-0-460" href="#__codelineno-0-460"></a><span class="w">                </span><span class="k">end</span>
<a id="__codelineno-0-461" name="__codelineno-0-461" href="#__codelineno-0-461"></a><span class="w">            </span><span class="k">end</span>
<a id="__codelineno-0-462" name="__codelineno-0-462" href="#__codelineno-0-462"></a><span class="w">        </span><span class="k">end</span>
<a id="__codelineno-0-463" name="__codelineno-0-463" href="#__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464" href="#__codelineno-0-464"></a><span class="w">    </span><span class="k">end</span><span class="w">     </span><span class="c1">//end of ant-parallel state </span>
<a id="__codelineno-0-465" name="__codelineno-0-465" href="#__codelineno-0-465"></a><span class="c1">//-------------------------------------------------------------------------------------------------------------</span>
<a id="__codelineno-0-466" name="__codelineno-0-466" href="#__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467" href="#__codelineno-0-467"></a><span class="w">    </span><span class="n">I</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">)</span><span class="o">&lt;+</span><span class="n">Id</span><span class="p">;</span><span class="w">           </span>
<a id="__codelineno-0-468" name="__codelineno-0-468" href="#__codelineno-0-468"></a><span class="k">end</span><span class="w">  </span><span class="c1">// end of transiant simulation </span>
<a id="__codelineno-0-469" name="__codelineno-0-469" href="#__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470" href="#__codelineno-0-470"></a><span class="c1">//-------------------------------------------------------------------------------------------------------------</span>
<a id="__codelineno-0-471" name="__codelineno-0-471" href="#__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472" href="#__codelineno-0-472"></a><span class="k">if</span><span class="p">(</span><span class="n">Temp_var</span><span class="o">==</span><span class="mh">1</span><span class="p">)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473" href="#__codelineno-0-473"></a><span class="k">begin</span><span class="w">      </span>
<a id="__codelineno-0-474" name="__codelineno-0-474" href="#__codelineno-0-474"></a><span class="w">    </span><span class="n">V</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;+</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">)</span><span class="o">*</span><span class="n">V</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mh">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">surface</span><span class="o">*</span><span class="n">lam</span><span class="o">/</span><span class="p">(</span><span class="n">thick_s</span><span class="o">-</span><span class="n">toxreal</span><span class="p">));</span><span class="w">   </span>
<a id="__codelineno-0-475" name="__codelineno-0-475" href="#__codelineno-0-475"></a><span class="w">    </span><span class="n">I</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;+</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">resistor</span><span class="p">;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476" href="#__codelineno-0-476"></a><span class="w">    </span><span class="n">I</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;+</span><span class="w"> </span><span class="n">capacitor</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">ddt</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">n2</span><span class="p">)));</span>
<a id="__codelineno-0-477" name="__codelineno-0-477" href="#__codelineno-0-477"></a><span class="k">end</span>
<a id="__codelineno-0-478" name="__codelineno-0-478" href="#__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479" href="#__codelineno-0-479"></a><span class="p">@(</span><span class="n">final_step</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-0-480" name="__codelineno-0-480" href="#__codelineno-0-480"></a><span class="c1">//$fclose(fp);</span>
<a id="__codelineno-0-481" name="__codelineno-0-481" href="#__codelineno-0-481"></a><span class="k">end</span>
<a id="__codelineno-0-482" name="__codelineno-0-482" href="#__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483" href="#__codelineno-0-483"></a><span class="k">end</span><span class="w"> </span><span class="c1">// end of the analog begin </span>
<a id="__codelineno-0-484" name="__codelineno-0-484" href="#__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485" href="#__codelineno-0-485"></a><span class="k">endmodule</span>
</code></pre></div>
</details>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../out_neuron/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Output Neuron">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Output Neuron
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>